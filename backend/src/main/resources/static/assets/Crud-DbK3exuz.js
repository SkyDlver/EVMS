import{aV as V,aH as j,r,e as K,o as W,c as q,a as v,b as a,w as n,aW as t,t as $,f as P,a4 as G}from"./index-dp35m7Uu.js";import{s as J}from"./index-CXKCeGC3.js";import{s as y}from"./index-DpuOfaz9.js";import{s as Q}from"./index-BGgiIkVm.js";import{s as u}from"./index-BT2BWPIG.js";import{s as g}from"./index-CrOHT5aP.js";import{s as F}from"./index-B9rc26ll.js";import{s as X}from"./index-6fnjTpfE.js";import"./index-C0Ah9irb.js";import"./index-Dz74ZRUj.js";import"./index-DKpM9OMF.js";import"./index-nqzbpG75.js";import"./index-Br-bELbp.js";import"./index-CQNsQlsD.js";import"./index-DoNpdhKS.js";import"./index-CvMjMBFO.js";import"./index-DQQMlm06.js";import"./index-j_bLqDgE.js";import"./index-aJLxYuNB.js";import"./index-CO8I-vE4.js";import"./index-C2GEnqbr.js";import"./index-BQkGYeP-.js";import"./index-BgQZtsT9.js";import"./index-BOb06Lor.js";const C={async getEmployees({departmentId:m,page:i=1,size:E=10,sort:d="id"}={}){const c={departmentId:m,page:i,size:E,sort:d};return(await V.get("/api/employees",{params:c})).data},async getEmployeeById(m){return(await V.get(`/api/employees/${m}`)).data},async createEmployee(m){return(await V.post("/api/employees",m)).data},async updateEmployee(m,i){return(await V.put(`/api/employees/${m}`,i)).data},async deleteEmployee(m){await V.delete(`/api/employees/${m}`)}},Z={class:"card"},_={class:"flex justify-between items-center"},ee={class:"flex flex-col gap-4"},xe={__name:"Crud",setup(m){const i=j(),E=r(null),d=r([]),c=r(!1),b=r(!1),w=r(!1),s=r({}),f=r([]),k=r(!1),M=r({global:{value:null,matchMode:G.CONTAINS}}),D=r(0),S=r(10);r(0);const O=r("id"),L=r(1);K(()=>x());async function x(o={}){try{const e=o.first?o.first/o.rows:0,l=o.rows||S.value,p=o.sortField?`${o.sortField},${o.sortOrder===1?"asc":"desc"}`:"id,asc",N=await C.getEmployees({page:e,size:l,sort:p});d.value=N.content||N,D.value=N.totalElements||d.value.length}catch(e){i.add({severity:"error",summary:"Error",detail:"Failed to load employees",life:3e3}),console.error(e)}}function R(o){x(o)}function h(o){x(o)}function H(){s.value={},k.value=!1,c.value=!0}function U(){c.value=!1,k.value=!1}async function A(){var o,e;if(k.value=!0,!(!((o=s.value.firstName)!=null&&o.trim())||!((e=s.value.lastName)!=null&&e.trim())))try{if(s.value.id){const l=await C.updateEmployee(s.value.id,s.value),p=d.value.findIndex(N=>N.id===l.id);p!==-1&&(d.value[p]=l),i.add({severity:"success",summary:"Updated",detail:"Employee updated",life:3e3})}else{const l=await C.createEmployee(s.value);d.value.push(l),i.add({severity:"success",summary:"Created",detail:"Employee created",life:3e3})}U(),s.value={}}catch(l){i.add({severity:"error",summary:"Error",detail:"Failed to save employee",life:3e3}),console.error(l)}}function I(o){s.value={...o},c.value=!0}function T(o){s.value=o,b.value=!0}async function B(){try{await C.deleteEmployee(s.value.id),d.value=d.value.filter(o=>o.id!==s.value.id),b.value=!1,f.value=f.value.filter(o=>o.id!==s.value.id),i.add({severity:"success",summary:"Deleted",detail:"Employee deleted",life:3e3})}catch(o){i.add({severity:"error",summary:"Error",detail:"Failed to delete employee",life:3e3}),console.error(o)}}function z(){w.value=!0}async function Y(){try{const o=f.value.map(e=>e.id);await Promise.all(o.map(e=>C.deleteEmployee(e))),d.value=d.value.filter(e=>!o.includes(e.id)),f.value=[],w.value=!1,i.add({severity:"success",summary:"Deleted",detail:"Selected employees deleted",life:3e3})}catch(o){i.add({severity:"error",summary:"Error",detail:"Failed to delete selected employees",life:3e3}),console.error(o)}}return(o,e)=>(W(),q("div",null,[v("div",Z,[a(t(Q),{class:"mb-6"},{start:n(()=>[a(t(u),{label:"New",icon:"pi pi-plus",class:"mr-2",onClick:H}),a(t(u),{label:"Delete",icon:"pi pi-trash",onClick:z,disabled:!f.value.length},null,8,["disabled"])]),end:n(()=>[a(t(u),{label:"Export",icon:"pi pi-upload",onClick:e[0]||(e[0]=l=>{var p;return(p=E.value.value)==null?void 0:p.exportCSV()})})]),_:1}),a(t(J),{ref_key:"dt",ref:E,selection:f.value,"onUpdate:selection":e[2]||(e[2]=l=>f.value=l),value:d.value,dataKey:"id",selectionMode:"multiple",paginator:!0,rows:S.value,totalRecords:D.value,lazy:!0,onPage:R,onSort:h,sortField:O.value,sortOrder:L.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} employees"},{header:n(()=>[v("div",_,[e[14]||(e[14]=v("h4",{class:"m-0"},"Manage Employees",-1)),a(t(g),{modelValue:M.value.global.value,"onUpdate:modelValue":e[1]||(e[1]=l=>M.value.global.value=l),placeholder:"Search...",class:"w-1/3"},null,8,["modelValue"])])]),default:n(()=>[a(t(y),{selectionMode:"multiple",style:{width:"3rem"}}),a(t(y),{field:"firstName",header:"First Name",sortable:""}),a(t(y),{field:"lastName",header:"Last Name",sortable:""}),a(t(y),{field:"middleName",header:"Middle Name",sortable:""}),a(t(y),{field:"roleInCompany",header:"Role",sortable:""}),a(t(y),{field:"hiredAt",header:"Hired At",sortable:""}),a(t(y),{field:"isOnHoliday",header:"Holiday",sortable:""},{body:n(l=>[v("span",null,$(l.data.isOnHoliday?"Yes":"No"),1)]),_:1}),a(t(y),{exportable:!1},{body:n(l=>[a(t(u),{icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2",onClick:p=>I(l.data)},null,8,["onClick"]),a(t(u),{icon:"pi pi-trash",outlined:"",rounded:"",severity:"danger",onClick:p=>T(l.data)},null,8,["onClick"])]),_:1})]),_:1},8,["selection","value","rows","totalRecords","sortField","sortOrder"])]),a(t(F),{visible:c.value,"onUpdate:visible":e[9]||(e[9]=l=>c.value=l),header:"Employee Details",modal:!0,style:{width:"450px"}},{footer:n(()=>[a(t(u),{label:"Cancel",text:"",icon:"pi pi-times",onClick:U}),a(t(u),{label:"Save",icon:"pi pi-check",onClick:A})]),default:n(()=>[v("div",ee,[a(t(g),{modelValue:s.value.firstName,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.firstName=l),modelModifiers:{trim:!0},placeholder:"First Name"},null,8,["modelValue"]),a(t(g),{modelValue:s.value.lastName,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.lastName=l),modelModifiers:{trim:!0},placeholder:"Last Name"},null,8,["modelValue"]),a(t(g),{modelValue:s.value.middleName,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.middleName=l),modelModifiers:{trim:!0},placeholder:"Middle Name"},null,8,["modelValue"]),a(t(g),{modelValue:s.value.roleInCompany,"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.roleInCompany=l),modelModifiers:{trim:!0},placeholder:"Role"},null,8,["modelValue"]),a(t(g),{type:"date",modelValue:s.value.hiredAt,"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.hiredAt=l)},null,8,["modelValue"]),a(t(X),{modelValue:s.value.isOnHoliday,"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.isOnHoliday=l)},null,8,["modelValue"]),e[15]||(e[15]=P(" On Holiday "))])]),_:1},8,["visible"]),a(t(F),{visible:b.value,"onUpdate:visible":e[11]||(e[11]=l=>b.value=l),header:"Confirm",modal:!0,style:{width:"400px"}},{footer:n(()=>[a(t(u),{label:"No",text:"",icon:"pi pi-times",onClick:e[10]||(e[10]=l=>b.value=!1)}),a(t(u),{label:"Yes",icon:"pi pi-check",onClick:B})]),default:n(()=>[v("p",null,[e[16]||(e[16]=P("Are you sure you want to delete ")),v("b",null,$(s.value.firstName)+" "+$(s.value.lastName),1),e[17]||(e[17]=P("?"))])]),_:1},8,["visible"]),a(t(F),{visible:w.value,"onUpdate:visible":e[13]||(e[13]=l=>w.value=l),header:"Confirm",modal:!0,style:{width:"400px"}},{footer:n(()=>[a(t(u),{label:"No",text:"",icon:"pi pi-times",onClick:e[12]||(e[12]=l=>w.value=!1)}),a(t(u),{label:"Yes",icon:"pi pi-check",onClick:Y})]),default:n(()=>[e[18]||(e[18]=v("p",null,"Are you sure you want to delete the selected employees?",-1))]),_:1},8,["visible"])]))}};export{xe as default};
